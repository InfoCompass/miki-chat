version: "2.0"

stories:

## What comes before questions

- story: start + help
  steps:
  - intent: start
  - action: utter_chitchat/chitchat_start
  - checkpoint: before_question

- story: before question check positive
  steps:
    - intent: affirm
    - action: utter_another_question
    - checkpoint: before_question

- story: before question check negative
  steps:
    - intent: deny
    - action: utter_rephrase_question
    - checkpoint: before_question

- story: before question filter_question confused
  steps:
    - intent: filter_question
    - action: utter_dont_understand
    - action: utter_ask_again
    - checkpoint: before_question

- story: before question filter question no results
  steps:
    - intent: filter_question
      entities:
        - filter
    - action: action_filter_results
    - slot_was_set:
        - action_filter_error: 'no_results_found'
    - action: reset_action_filter_error
    - slot_was_set:
        - action_filter_error: null
    - action: utter_ask_another_question
    - checkpoint: before_question

- story: before question filter question unknown keyword
  steps:
    - intent: filter_question
      entities:
        - filter
    - action: action_filter_results
    - slot_was_set:
        - action_filter_error: 'keyword_not_understood'
    - action: reset_action_filter_error
    - slot_was_set:
        - action_filter_error: null
    - action: utter_ask_question_another_form
    - checkpoint: before_question

- story: faq
  steps:
  - checkpoint: before_question
  - intent: faq
  - action: utter_faq
  - action: utter_ask_whether_question_answered

- story: no more questions + goodbye
  steps:
    - checkpoint: before_question
    - intent: deny
    - action: utter_chitchat/chitchat_bye

- story: filter question
  steps:
  - checkpoint: before_question
  - intent: filter_question
    entities:
      - filter
  - action: action_filter_results
  - action: utter_ask_whether_question_answered

- story: filter question no results
  steps:
    - checkpoint: before_question
    - intent: filter_question
      entities:
        - filter
    - action: action_filter_results
    - slot_was_set:
        - action_filter_error: 'no_results_found'
    - action: reset_action_filter_error
    - slot_was_set:
        - action_filter_error: null
    - action: utter_ask_another_question

- story: filter question unknown keyword
  steps:
    - checkpoint: before_question
    - intent: filter_question
      entities:
        - filter
    - action: action_filter_results
    - slot_was_set:
        - action_filter_error: 'keyword_not_understood'
    - action: reset_action_filter_error
    - slot_was_set:
        - action_filter_error: null
    - action: utter_ask_question_another_form

- story: filter_question confused
  steps:
    - checkpoint: before_question
    - intent: filter_question
    - action: utter_dont_understand
    - action: utter_ask_again

## Continuing the check after a question

- story: faq before check
  steps:
  - intent: faq
  - action: utter_faq
  - action: utter_ask_whether_question_answered
  - checkpoint: before_check

- story: filter question before check
  steps:
  - intent: filter_question
    entities:
      - filter
  - action: action_filter_results
  - action: utter_ask_whether_question_answered
  - checkpoint: before_check

- story: check answered positive
  steps:
  - checkpoint: before_check
  - intent: affirm
  - action: utter_another_question

- story: check answered negative
  steps:
  - checkpoint: before_check
  - intent: deny
  - action: utter_rephrase_question

